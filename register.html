<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - ElderConnect</title>
    <link rel="stylesheet" href="jumpstarter-design-system.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #5a8de8;
            --primary-dark: #4472ca;
            --secondary: #7dd3a0;
            --accent: #8ca0d7;
            --surface: #253447;
            --surface-alt: #1a2332;
            --outline: #3d556f;
            --text-main: #e8f0f8;
            --text-muted: #b8c8d8;
        }

        body {
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            min-height: 100vh;
            background: radial-gradient(circle at 18% 20%, rgba(90, 141, 232, 0.15), transparent 55%),
                        radial-gradient(circle at 82% 78%, rgba(125, 211, 160, 0.12), transparent 60%),
                        var(--surface-alt);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: var(--spacing-md);
        }

        .register-container {
            background: var(--surface);
            border-radius: 28px;
            box-shadow: 0 26px 60px rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(90, 141, 232, 0.4);
            overflow: hidden;
            width: min(720px, 100%);
            padding: clamp(32px, 5vw, 48px);
            border: 2px solid var(--border);
        }

        .form-section {
            background: var(--surface);
        }

        .logo {
            font-size: clamp(2rem, 4vw, 2.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--primary-light-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: var(--spacing-md);
        }

        h1 {
            text-align: center;
            font-size: clamp(1.75rem, 4vw, 2.5rem);
            color: var(--dark-blue-text);
            margin: 0 0 var(--spacing-md) 0;
            font-weight: 700;
        }

        p.subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin: 0 0 var(--spacing-lg) 0;
            font-size: var(--font-size-base);
        }

        .trust-banner {
            background: var(--primary-light-blue);
            color: var(--white);
            border-radius: var(--radius-md);
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-sm);
            text-align: center;
            margin-bottom: var(--spacing-lg);
            box-shadow: var(--shadow-sm);
        }

        .form-group {
            margin-bottom: var(--spacing-md);
        }

        label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-weight: 600;
            color: var(--dark-blue-text);
            font-size: var(--font-size-base);
        }

        input[type="text"],
        input[type="number"],
        input[type="email"],
        input[type="tel"],
        select,
        textarea {
            width: 100%;
            padding: 14px 16px;
            border-radius: 16px;
            border: 2px solid var(--outline);
            background: rgba(45, 63, 86, 0.6);
            font-size: 0.98rem;
            font-family: inherit;
            color: var(--dark-blue-text);
            transition: all 0.3s ease;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(90, 141, 232, 0.3);
            background: rgba(45, 63, 86, 0.8);
            transform: translateY(-1px);
        }

        textarea {
            resize: vertical;
        }

        .radio-group,
        .checkbox-group,
        .volunteer-focus-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 14px;
        }

        .radio-item,
        .checkbox-item {
            padding: 14px 16px;
            border-radius: 16px;
            border: 2px solid var(--outline);
            background: rgba(45, 63, 86, 0.6);
            display: flex;
            gap: var(--spacing-sm);
            align-items: flex-start;
            transition: all 0.3s ease;
        }

        .radio-item:hover,
        .checkbox-item:hover {
            border-color: var(--primary);
            box-shadow: 0 16px 30px rgba(90, 141, 232, 0.3);
            background: rgba(45, 63, 86, 0.8);
        }

        .radio-item input,
        .checkbox-item input {
            margin-top: 6px;
        }

        .submit-btn {
            margin-top: var(--spacing-md);
            width: 100%;
            padding: 15px 20px;
            border-radius: 18px;
            border: 2px solid rgba(90, 141, 232, 0.5);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: #ffffff;
            font-size: 1.05rem;
            font-weight: 600;
            letter-spacing: 0.3px;
            box-shadow: 0 22px 40px rgba(90, 141, 232, 0.5);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .submit-btn:hover {
            background: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 26px 48px rgba(90, 141, 232, 0.6);
            border-color: rgba(90, 141, 232, 0.7);
        }

        small,
        .field-note {
            display: block;
            margin-top: 6px;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .double-column {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
        }

        .survey-section,
        .volunteer-section,
        #elder-wellbeing-section {
            background: rgba(37, 52, 71, 0.6);
            border-radius: 22px;
            border: 2px solid rgba(90, 141, 232, 0.3);
            padding: 26px;
            margin-top: 28px;
            box-shadow: 0 16px 30px rgba(0, 0, 0, 0.3);
        }

        .survey-section h2,
        .volunteer-section h2 {
            margin: 0 0 16px 0;
            font-size: 1.35rem;
            color: var(--text-main);
        }

        .back-link {
            text-align: center;
            margin-top: 28px;
        }

        .back-link a {
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
        }

        .back-link a:hover {
            text-decoration: underline;
        }

        @media (max-width: 900px) {
            body {
                padding: 16px;
            }
            .register-container {
                grid-template-columns: 1fr;
                border-radius: 24px;
            }
            .illustration-section {
                padding: 36px 32px;
            }
            .form-section {
                padding: 36px 28px;
            }
        }
    </style>
  </head>
  <body>
    <div class="register-container">
      <div class="form-section">
        <div class="logo">ElderConnect</div>
        <div class="trust-banner">üîí Your data is safe and never shared outside ElderConnect.</div>
        <h1>Create Your Profile</h1>
        <p class="subtitle">Help us personalize your experience and connect you with activities that match your interests.</p>

        <form id="registration-form">
          <div class="form-group">
            <label>Your Role *</label>
            <div class="radio-group">
              <label class="radio-item">
                <input type="radio" id="role-elderly" name="userType" value="elderly" checked>
                <span>Elderly User (looking for activities and companionship)</span>
              </label>
              <label class="radio-item">
                <input type="radio" id="role-volunteer" name="userType" value="volunteer">
                <span>Volunteer (supporting elderly members)</span>
              </label>
            </div>
            <small>Volunteers get access to rating tools and wellness check-ins so they can help seniors thrive.</small>
          </div>

          <div class="volunteer-section" id="volunteer-focus-section" style="display: none;">
            <h2>Volunteer Preferences</h2>
            <div class="form-group">
              <label for="volunteer-experience">Previous experience supporting seniors *</label>
              <select id="volunteer-experience" name="volunteerExperience" class="volunteer-field" required>
                <option value="">Select your experience level</option>
                <option value="first-time">First-time volunteer</option>
                <option value="some-experience">Some informal experience</option>
                <option value="professional">Professional caregiver / social worker</option>
              </select>
            </div>
            <div class="form-group">
              <label>How would you like to help? *</label>
              <div class="checkbox-group volunteer-focus-group">
                <label class="checkbox-item">
                  <input type="checkbox" name="volunteerFocus" value="companionship" class="volunteer-field">
                  Friendly companionship &amp; conversation circles
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="volunteerFocus" value="wellness-checks" class="volunteer-field">
                  Wellness check-ins &amp; confidence coaching
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="volunteerFocus" value="event-support" class="volunteer-field">
                  Event support &amp; activity coordination
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="volunteerFocus" value="logistics" class="volunteer-field">
                  Logistics (transport, reminders, scheduling)
                </label>
              </div>
            </div>
            <div class="form-group">
              <label for="volunteer-qualifications">Relevant qualifications or training</label>
              <textarea id="volunteer-qualifications" name="volunteerQualifications" class="volunteer-field" rows="3" placeholder="List any caregiving, counselling, social work or specialised training"></textarea>
            </div>
            <div class="form-group">
              <label>Do you hold a valid first-aid certificate? *</label>
              <div class="radio-group volunteer-first-aid">
                <label class="radio-item">
                  <input type="radio" id="first-aid-yes" name="volunteerFirstAid" value="yes" class="volunteer-field" required>
                  Yes, within the last 2 years
                </label>
                <label class="radio-item">
                  <input type="radio" id="first-aid-in-progress" name="volunteerFirstAid" value="in-progress" class="volunteer-field">
                  Currently training / scheduled
                </label>
                <label class="radio-item">
                  <input type="radio" id="first-aid-no" name="volunteerFirstAid" value="no" class="volunteer-field">
                  Not yet, would like support
                </label>
              </div>
            </div>
            <div class="form-group">
              <label for="volunteer-motivation">What motivates you to volunteer?</label>
              <textarea id="volunteer-motivation" name="volunteerMotivation" class="volunteer-field" rows="3" placeholder="Tell us about the impact you want to make"></textarea>
            </div>
          </div>

          <div class="form-group">
            <label for="preferred-name">Preferred Name *</label>
            <input type="text" id="preferred-name" name="preferredName" placeholder="Enter your preferred name" required>
            <small>The app will call you by this name</small>
          </div>

          <div class="form-group">
            <label for="age">Age *</label>
            <input type="number" id="age" name="age" min="50" data-elder-min="50" data-elder-placeholder="Enter your age (50+)" data-volunteer-placeholder="Enter your age" placeholder="Enter your age (50+)" required>
            <small>To group you with similar age participants</small>
          </div>

          <div class="form-group">
            <label for="gender">Gender *</label>
            <select id="gender" name="gender" required>
              <option value="">Select your gender</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="non-binary">Non-binary</option>
              <option value="prefer-not-to-say">Prefer not to say</option>
            </select>
          </div>

          <div class="form-group">
            <label for="medical-needs">Medical Needs or Disabilities</label>
            <textarea id="medical-needs" name="medicalNeeds" placeholder="Any medical conditions, mobility issues, or special requirements we should know about?" rows="3"></textarea>
          </div>

          <div class="form-group">
            <label>Interests and Hobbies *</label>
            <small>Select all that apply</small>
            <div class="checkbox-group">
              <label class="checkbox-item">
                <input type="checkbox" id="interest1" name="interests" value="Board Games">
                Board Games
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest2" name="interests" value="Gardening">
                Gardening
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest3" name="interests" value="Reading">
                Reading
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest4" name="interests" value="Cooking">
                Cooking
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest5" name="interests" value="Arts &amp; Crafts">
                Arts &amp; Crafts
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest6" name="interests" value="Music">
                Music
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest7" name="interests" value="Walking">
                Walking
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest8" name="interests" value="Travel">
                Travel
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest9" name="interests" value="Volunteering">
                Volunteering
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="interest10" name="interests" value="Technology">
                Technology
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="personality">Personality Type *</label>
            <select id="personality" name="personality" required>
              <option value="">Select your personality type</option>
              <option value="introvert">Introvert</option>
              <option value="extrovert">Extrovert</option>
              <option value="ambivert">Ambivert</option>
            </select>
          </div>

          <div class="elder-wellbeing" id="elder-wellbeing-section">
            <div class="form-group">
              <label for="loneliness-level">Loneliness Level *</label>
              <select id="loneliness-level" name="lonelinessLevel" class="survey-field" required>
                <option value="">Select your current loneliness level</option>
                <option value="mild">Mild - I feel generally connected but sometimes lonely</option>
                <option value="moderate">Moderate - I often feel lonely and seek more connections</option>
                <option value="severe">Severe - I feel isolated and need significant support</option>
              </select>
              <small>This helps us recommend activities that best suit your social needs</small>
            </div>

            <div class="form-group">
              <label for="well-being-goals">Well-being Goals</label>
              <textarea id="well-being-goals" name="wellBeingGoals" class="survey-field" placeholder="What would you like to improve about your mental well-being? (e.g., reduce loneliness, find motivation, build confidence)" rows="3"></textarea>
              <small>For users with severe loneliness, we provide additional AI support and therapeutic activities</small>
            </div>
          </div>

          <div class="survey-section" id="elder-survey-section">
            <h2>Account Registration Survey</h2>

            <div class="form-group">
              <label for="daily-talking-time">How long do you spend talking with people every day? *</label>
              <input type="text" id="daily-talking-time" name="dailyTalkingTime" class="survey-field" placeholder="e.g., 2 hours, 30 minutes, etc." required>
            </div>

            <div class="form-group">
              <label>How often do you feel that you lack companionship? *</label>
              <div class="radio-group">
                <label class="radio-item">
                  <input type="radio" id="companionship-never" name="lackCompanionship" class="survey-field" value="never" required>
                  Never
                </label>
                <label class="radio-item">
                  <input type="radio" id="companionship-seldom" name="lackCompanionship" class="survey-field" value="seldom">
                  Seldom
                </label>
                <label class="radio-item">
                  <input type="radio" id="companionship-sometimes" name="lackCompanionship" class="survey-field" value="sometimes">
                  Sometimes
                </label>
                <label class="radio-item">
                  <input type="radio" id="companionship-always" name="lackCompanionship" class="survey-field" value="always">
                  Always
                </label>
              </div>
            </div>

            <div class="form-group">
              <label>How often do you feel lonely? *</label>
              <div class="radio-group">
                <label class="radio-item">
                  <input type="radio" id="lonely-never" name="feelLonely" class="survey-field" value="never" required>
                  Never
                </label>
                <label class="radio-item">
                  <input type="radio" id="lonely-seldom" name="feelLonely" class="survey-field" value="seldom">
                  Seldom
                </label>
                <label class="radio-item">
                  <input type="radio" id="lonely-sometimes" name="feelLonely" class="survey-field" value="sometimes">
                  Sometimes
                </label>
                <label class="radio-item">
                  <input type="radio" id="lonely-always" name="feelLonely" class="survey-field" value="always">
                  Always
                </label>
              </div>
            </div>

            <div class="form-group">
              <label>Do you feel that you have someone to talk to when you need support? *</label>
              <div class="radio-group">
                <label class="radio-item">
                  <input type="radio" id="support-yes" name="hasSupport" class="survey-field" value="yes" required>
                  Yes
                </label>
                <label class="radio-item">
                  <input type="radio" id="support-no" name="hasSupport" class="survey-field" value="no">
                  No
                </label>
                <label class="radio-item">
                  <input type="radio" id="support-sometimes" name="hasSupport" class="survey-field" value="sometimes">
                  Sometimes
                </label>
              </div>
            </div>

            <div class="form-group">
              <label for="social-activities-frequency">How often do you engage in social activities or group events? *</label>
              <select id="social-activities-frequency" name="socialActivitiesFrequency" class="survey-field" required>
                <option value="">Select frequency</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
              </select>
            </div>

            <div class="form-group">
              <label for="living-situation">Do you live alone or with others? *</label>
              <input type="text" id="living-situation" name="livingSituation" class="survey-field" placeholder="e.g., Alone, With partner, With family" required>
            </div>

            <div class="form-group">
              <label for="preferred-group-size">Preferred group size *</label>
              <select id="preferred-group-size" name="preferredGroupSize" class="survey-field" required>
                <option value="">Select your comfort level</option>
                <option value="one-on-one">One-on-one or buddy activities</option>
                <option value="small-group">Small group (3-5 people)</option>
                <option value="medium-group">Medium group (6-10 people)</option>
                <option value="large-group">Large gatherings (10+ people)</option>
              </select>
            </div>

            <div class="form-group">
              <label for="social-relationships-satisfaction">How satisfied are you with your social relationships? *</label>
              <select id="social-relationships-satisfaction" name="socialRelationshipsSatisfaction" class="survey-field" required>
                <option value="">Select rating (1-10)</option>
                <option value="1">1 - Very Dissatisfied</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 - Neutral</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10 - Very Satisfied</option>
              </select>
            </div>

            <div class="form-group">
              <label>Do you feel useless or without purpose? *</label>
              <div class="radio-group">
                <label class="radio-item">
                  <input type="radio" id="useless-yes" name="feelUseless" value="yes" required>
                  Yes
                </label>
                <label class="radio-item">
                  <input type="radio" id="useless-no" name="feelUseless" value="no">
                  No
                </label>
                <label class="radio-item">
                  <input type="radio" id="useless-sometimes" name="feelUseless" value="sometimes">
                  Sometimes
                </label>
              </div>
            </div>

            <div class="form-group">
              <label>Do you dislike yourself or have negative feelings about who you are? *</label>
              <div class="radio-group">
                <label class="radio-item">
                  <input type="radio" id="negative-feelings-yes" name="negativeFeelings" class="survey-field" value="yes" required>
                  Yes
                </label>
                <label class="radio-item">
                  <input type="radio" id="negative-feelings-no" name="negativeFeelings" class="survey-field" value="no">
                  No
                </label>
                <label class="radio-item">
                  <input type="radio" id="negative-feelings-sometimes" name="negativeFeelings" class="survey-field" value="sometimes">
                  Sometimes
                </label>
              </div>
            </div>
          </div>

          <button type="submit" class="submit-btn">Save Profile &amp; Continue</button>
        </form>

        <div class="back-link">
          <a href="index.html">‚Üê Back to Welcome Page</a>
        </div>

        <div class="back-link" style="margin-top: 10px;">
          <a href="settings.html">‚öôÔ∏è Account Settings</a>
        </div>
      </div>
    </div>

    <script>
        const surveySection = document.getElementById('elder-survey-section');
        const wellbeingSection = document.getElementById('elder-wellbeing-section');
        const surveyFields = Array.from(document.querySelectorAll('.survey-field'));
        const roleInputs = document.querySelectorAll('input[name="userType"]');
        const volunteerSectionEl = document.getElementById('volunteer-focus-section');
        const volunteerFields = volunteerSectionEl ? Array.from(volunteerSectionEl.querySelectorAll('.volunteer-field')) : [];
        const volunteerFocusCheckboxes = volunteerSectionEl ? Array.from(volunteerSectionEl.querySelectorAll('input[name="volunteerFocus"]')) : [];
        const volunteerFirstAidRadios = volunteerSectionEl ? Array.from(volunteerSectionEl.querySelectorAll('input[name="volunteerFirstAid"]')) : [];
        const ageInput = document.getElementById('age');

        function storeOriginalRequirement(field) {
            if (!field.dataset.originalRequired) {
                field.dataset.originalRequired = field.hasAttribute('required') ? 'true' : 'false';
            }
        }

        surveyFields.forEach(storeOriginalRequirement);
        volunteerFields.forEach(storeOriginalRequirement);

        function setFieldRequired(field, shouldRequire) {
            if (shouldRequire) {
                if (field.dataset.originalRequired === 'true') {
                    field.setAttribute('required', '');
                }
            } else {
                field.removeAttribute('required');
            }
        }

        function clearField(field) {
            if (field.type === 'radio' || field.type === 'checkbox') {
                field.checked = false;
            } else if (field.tagName === 'SELECT') {
                field.selectedIndex = 0;
            } else {
                field.value = '';
            }
        }

        function updateRoleSections(selectedRole) {
            const isVolunteer = selectedRole === 'volunteer';
            document.body.setAttribute('data-registration-role', isVolunteer ? 'volunteer' : 'elderly');

            if (surveySection) {
                if (isVolunteer) {
                    surveySection.style.display = 'none';
                    if (wellbeingSection) {
                        wellbeingSection.style.display = 'none';
                    }
                    surveyFields.forEach(field => {
                        setFieldRequired(field, false);
                        clearField(field);
                    });
                } else {
                    surveySection.style.display = '';
                    if (wellbeingSection) {
                        wellbeingSection.style.display = '';
                    }
                    surveyFields.forEach(field => {
                        setFieldRequired(field, true);
                    });
                }
            }

            if (volunteerSectionEl) {
                if (isVolunteer) {
                    volunteerSectionEl.style.display = '';
                    volunteerFields.forEach(field => {
                        if (field.type === 'checkbox' || field.type === 'radio') {
                            field.removeAttribute('required');
                        } else {
                            setFieldRequired(field, true);
                        }
                    });
                    if (volunteerFocusCheckboxes.length > 0) {
                        volunteerFocusCheckboxes[0].setAttribute('required', '');
                    }
                    if (volunteerFirstAidRadios.length > 0) {
                        volunteerFirstAidRadios[0].setAttribute('required', '');
                    }
                } else {
                    volunteerSectionEl.style.display = 'none';
                    volunteerFields.forEach(field => {
                        setFieldRequired(field, false);
                        clearField(field);
                    });
                    volunteerFocusCheckboxes.forEach(box => {
                        box.removeAttribute('required');
                        box.checked = false;
                    });
                    volunteerFirstAidRadios.forEach(radio => {
                        radio.removeAttribute('required');
                        radio.checked = false;
                    });
                }
            }

            if (ageInput) {
                if (isVolunteer) {
                    ageInput.removeAttribute('min');
                    ageInput.placeholder = ageInput.dataset.volunteerPlaceholder || 'Enter your age';
                } else {
                    if (ageInput.dataset.elderMin) {
                        ageInput.setAttribute('min', ageInput.dataset.elderMin);
                    }
                    ageInput.placeholder = ageInput.dataset.elderPlaceholder || ageInput.placeholder;
                }
            }
        }

        roleInputs.forEach(input => {
            input.addEventListener('change', function() {
                updateRoleSections(this.value);
            });
        });

        const initialRoleInput = document.querySelector('input[name="userType"]:checked');
        updateRoleSections(initialRoleInput ? initialRoleInput.value : 'elderly');

        document.getElementById('registration-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            console.log('Form submission started');
            
            // Get form data
            const formData = new FormData(this);
            const profileData = {};
            
            // Collect text inputs and selects
            for (const [key, value] of formData.entries()) {
                if (key !== 'interests' && key !== 'volunteerFocus') {
                    profileData[key] = value;
                }
            }
            
            // Collect interests (multiple checkboxes)
            const interests = formData.getAll('interests');
            profileData.interests = interests;

            const volunteerFocus = formData.getAll('volunteerFocus');
            if (volunteerFocus.length > 0) {
                profileData.volunteerFocus = volunteerFocus;
            } else {
                delete profileData.volunteerFocus;
            }

            const selectedRole = profileData.userType || 'elderly';

            if (selectedRole === 'volunteer') {
                delete profileData.lonelinessLevel;
                delete profileData.wellBeingGoals;
                delete profileData.mentalWellBeingCategory;
            } else {
                const lonelinessLevel = profileData.lonelinessLevel;
                if (lonelinessLevel === 'mild') {
                    profileData.mentalWellBeingCategory = 'social';
                } else if (lonelinessLevel === 'moderate') {
                    profileData.mentalWellBeingCategory = 'balanced';
                } else if (lonelinessLevel === 'severe') {
                    profileData.mentalWellBeingCategory = 'wellness';
                } else {
                    delete profileData.mentalWellBeingCategory;
                }
            }

            console.log('Profile data collected:', profileData);
            
            // Store in localStorage for persistence
            try {
                console.log('Attempting to save profile to localStorage');
                localStorage.setItem('elderConnectProfile', JSON.stringify(profileData));
                
                // Verify that the profile was saved
                const savedProfile = localStorage.getItem('elderConnectProfile');
                console.log('Profile saved to localStorage:', savedProfile);
                
                // Show success message and redirect
                alert(`Thank you, ${profileData.preferredName || 'valued member'}! Your profile has been saved successfully.`);
                if (profileData.userType === 'volunteer') {
                    window.location.href = 'volunteer-dashboard.html';
                } else {
                    window.location.href = 'elder-connect-simple.html';
                }
            } catch (error) {
                console.error('Error saving profile:', error);
                alert('There was an error saving your profile. Please try again.');
            }
        });
        
        // Check if user already has a profile
        document.addEventListener('DOMContentLoaded', function() {
            const savedProfile = localStorage.getItem('elderConnectProfile');
            if (savedProfile) {
                try {
                    const profileData = JSON.parse(savedProfile);
                    console.log('Existing profile data loaded:', profileData);
                    if (profileData.preferredName) {
                        document.getElementById('preferred-name').value = profileData.preferredName;
                    }
                    if (profileData.age) {
                        document.getElementById('age').value = profileData.age;
                    }
                    if (profileData.gender) {
                        document.getElementById('gender').value = profileData.gender;
                    }
                    if (profileData.medicalNeeds) {
                        document.getElementById('medical-needs').value = profileData.medicalNeeds;
                    }
                    if (profileData.interests && Array.isArray(profileData.interests)) {
                        profileData.interests.forEach(interest => {
                            const checkbox = document.querySelector(`input[value="${interest}"]`);
                            if (checkbox) {
                                checkbox.checked = true;
                            }
                        });
                    }
                    if (profileData.personality) {
                        document.getElementById('personality').value = profileData.personality;
                    }
                    if (profileData.lonelinessLevel) {
                        document.getElementById('loneliness-level').value = profileData.lonelinessLevel;
                    }
                    if (profileData.wellBeingGoals) {
                        document.getElementById('well-being-goals').value = profileData.wellBeingGoals;
                    }
                    // Load survey data
                    if (profileData.dailyTalkingTime) {
                        document.getElementById('daily-talking-time').value = profileData.dailyTalkingTime;
                    }
                    if (profileData.lackCompanionship) {
                        const companionshipRadio = document.querySelector(`input[name="lackCompanionship"][value="${profileData.lackCompanionship}"]`);
                        if (companionshipRadio) companionshipRadio.checked = true;
                    }
                    if (profileData.feelLonely) {
                        const lonelyRadio = document.querySelector(`input[name="feelLonely"][value="${profileData.feelLonely}"]`);
                        if (lonelyRadio) lonelyRadio.checked = true;
                    }
                    if (profileData.hasSupport) {
                        const supportRadio = document.querySelector(`input[name="hasSupport"][value="${profileData.hasSupport}"]`);
                        if (supportRadio) supportRadio.checked = true;
                    }
                    if (profileData.socialActivitiesFrequency) {
                        document.getElementById('social-activities-frequency').value = profileData.socialActivitiesFrequency;
                    }
                    if (profileData.livingSituation) {
                        document.getElementById('living-situation').value = profileData.livingSituation;
                    }
                    if (profileData.preferredGroupSize) {
                        document.getElementById('preferred-group-size').value = profileData.preferredGroupSize;
                    }
                    if (profileData.socialRelationshipsSatisfaction) {
                        document.getElementById('social-relationships-satisfaction').value = profileData.socialRelationshipsSatisfaction;
                    }
                    if (profileData.feelUseless) {
                        const uselessRadio = document.querySelector(`input[name="feelUseless"][value="${profileData.feelUseless}"]`);
                        if (uselessRadio) uselessRadio.checked = true;
                    }
                    if (profileData.negativeFeelings) {
                        const negativeRadio = document.querySelector(`input[name="negativeFeelings"][value="${profileData.negativeFeelings}"]`);
                        if (negativeRadio) negativeRadio.checked = true;
                    }
                    if (profileData.userType) {
                        const roleInput = document.querySelector(`input[name="userType"][value="${profileData.userType}"]`);
                        if (roleInput) roleInput.checked = true;
                    }
                    if (profileData.volunteerExperience) {
                        const experienceSelect = document.getElementById('volunteer-experience');
                        if (experienceSelect) experienceSelect.value = profileData.volunteerExperience;
                    }
                    if (profileData.volunteerFocus && Array.isArray(profileData.volunteerFocus)) {
                        profileData.volunteerFocus.forEach(focus => {
                            const focusCheckbox = document.querySelector(`input[name="volunteerFocus"][value="${focus}"]`);
                            if (focusCheckbox) focusCheckbox.checked = true;
                        });
                    }
                    if (profileData.volunteerFocus && !Array.isArray(profileData.volunteerFocus)) {
                        const focusCheckbox = document.querySelector(`input[name="volunteerFocus"][value="${profileData.volunteerFocus}"]`);
                        if (focusCheckbox) focusCheckbox.checked = true;
                    }
                    if (profileData.volunteerFirstAid) {
                        const firstAidRadio = document.querySelector(`input[name="volunteerFirstAid"][value="${profileData.volunteerFirstAid}"]`);
                        if (firstAidRadio) firstAidRadio.checked = true;
                    }
                    if (profileData.volunteerQualifications) {
                        const qualificationsField = document.getElementById('volunteer-qualifications');
                        if (qualificationsField) qualificationsField.value = profileData.volunteerQualifications;
                    }
                    if (profileData.volunteerMotivation) {
                        const motivationField = document.getElementById('volunteer-motivation');
                        if (motivationField) motivationField.value = profileData.volunteerMotivation;
                    }
                    updateRoleSections(profileData.userType || 'elderly');
                } catch (e) {
                    console.error('Error loading saved profile:', e);
                }
            }
        });
    </script>
</body>
</html>